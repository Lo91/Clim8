<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>CliM8 1.0</title>
		
		
		<!-- 1. Add these JavaScript inclusions in the head of your page -->
		<script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
		<script type="text/javascript" src="http://code.highcharts.com/highcharts.js"></script>
		
		
		<!-- 2. Add the JavaScript to initialize the chart on document ready -->
		<script type="text/javascript">
		$(document).ready(function() {


$.get('current.csv', function(data) {

var optionsT = {
        chart: {
            renderTo: 'containerT',
            type: 'line'
        },
        title: {
            text: 'Temperature'
        },
        xAxis: {
            type: 'datetime',
            title: {
                text: 'Date'
            },
            //categories: []
        },
        yAxis: {
            title: {
                text: 'Temperature Â°C'
            }
        },
       series: [],

        navigator: {
            enabled: true
        },

        rangeSelector: {
            selected: 1
        },
    };
var optionsH = {
        chart: {
            renderTo: 'containerH',
            type: 'spline',
        },
        plotOptions: {
            dashStyle: 'dot'
        },
        title: {
            text: 'Humidity'
        },
        xAxis: {
            type: 'datetime',
            title: {
                text: 'Date'
            },
            //categories: []
        },
        yAxis: {
            title: {
                text: 'Humidity %'
            }
        },
       series: []
    };

    var lines = data.split('\n');

    var seriesT = [];
    var seriesH = [];
    // Iterate over the lines and add categories or series
    $.each(lines, function(lineNo, line) {
        var fields = line.split(',');
        if( fields.length < 2 )
        	return;
        var room = fields[1];
	if( !(room in seriesH) )
{
	seriesT[room] = {
		name: room,
		data: []
		};
 	optionsT.series.push(seriesT[room]);

	seriesH[room] = {
		name: room,
		data: []
		};
 	optionsH.series.push(seriesH[room]);
}
        var atDate = new Date( fields[0] );
        var atTime = atDate.getTime();
        var valT = parseFloat(fields[2]);
        var colsT = [ atTime, valT ];
        var colsH = [ atTime, parseFloat(fields[3]) ];
        if( lineNo % 5 == 0)
        {
        	//options.xAxis.categories.push( atTime );
        	seriesT[room].data.push(colsT);
        	seriesH[room].data.push(colsH);
        }
    });
    
    var chartT = new Highcharts.Chart(optionsT);
    var chartH = new Highcharts.Chart(optionsH);

});

});

</script>
<body>
<div id="containerT" style="height: 500px; min-width: 500px"></div>
<div id="containerH" style="height: 500px; min-width: 500px"></div>
	
</body>
</html>
